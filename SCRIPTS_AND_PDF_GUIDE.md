# ๐ฆ ุฏููู ูุธุงู ุงูุณูุฑูุจุชุงุช ูPDF

## ๐ 1. ูุธุงู ุชุญููู ุงูุฅูุตุงูุงุช ุฅูู PDF

### **ุงููุฒุงูุง:**
- โ ุชุญููู ูู ุฅูุตุงู ุฅูู PDF ุชููุงุฆูุงู
- โ ุญูุธ ูุณุฎุฉ PDF ูู ูู ุฅูุตุงู
- โ ุฅููุงููุฉ ุฅุฑุณุงู PDF ุนูู WhatsApp
- โ Fallback ููุทุจุงุนุฉ ุงูุชูููุฏูุฉ ุฅุฐุง ูุดู PDF

### **ุงูุงุณุชุฎุฏุงู:**

#### **1. ุงูุทุจุงุนุฉ ูุน PDF (ุงูุงูุชุฑุงุถู):**
```typescript
import { printReceiptFromData } from '@/lib/printSystem'

await printReceiptFromData(
  receiptNumber,
  'Member',
  500,
  { memberName: 'ูุญูุฏ ุฃุญูุฏ', memberNumber: 1234 },
  new Date(),
  'cash'
)
```

**ูุงุฐุง ูุญุฏุซุ**
- โ ููุชุญ ูุงูุฐุฉ ุงูุทุจุงุนุฉ
- โ ูุญูุธ PDF ุชููุงุฆูุงู ูู Downloads
- โ ูุนุทูู ุฑุงุจุท ุงูู PDF ููุงุณุชุฎุฏุงู ูุงุญูุงู

#### **2. PDF ููุท (ุจุฏูู ุทุจุงุนุฉ):**
```typescript
await printReceiptFromData(
  receiptNumber,
  'Member',
  500,
  details,
  new Date(),
  'cash',
  { pdfOnly: true }  // โ PDF ููุท ุจุฏูู ุทุจุงุนุฉ
)
```

#### **3. ุญูุธ PDF ูู ูุฌูุฏ ูุญูู (Electron):**
```typescript
import { savePDFLocally } from '@/lib/pdfSystem'

const htmlContent = generateReceiptHTMLExport(...)
const result = await savePDFLocally(htmlContent, receiptNumber, 'C:/receipts')

if (result.success) {
  console.log('ุชู ุงูุญูุธ ูู:', result.filePath)
}
```

#### **4. ุฅุฑุณุงู PDF ุนูู WhatsApp:**
```typescript
import { sharePDFWhatsApp } from '@/lib/pdfSystem'

const htmlContent = generateReceiptHTMLExport(...)
const result = await sharePDFWhatsApp(htmlContent, receiptNumber, '201234567890')

if (result.success) {
  console.log('ุชู ูุชุญ WhatsApp')
}
```

---

## ๐ 2. ูุธุงู ุฅุฏุงุฑุฉ ุงูุณูุฑูุจุชุงุช

### **ุงููุฒุงูุง:**
- โ ุชุชุจุน ุงูุณูุฑูุจุชุงุช ุงููููุฐุฉ
- โ ููุน ุชูููุฐ ููุณ ุงูุณูุฑูุจุช ูุฑุชูู
- โ ุฅููุงููุฉ ุฅุนุงุฏุฉ ุชุนููู ุณูุฑูุจุช
- โ ุณุฌู ูุงูู ุจุงููุฌุงุญ/ุงููุดู

### **ุงูุงุณุชุฎุฏุงู:**

#### **1. ุฅูุดุงุก ุณูุฑูุจุช ุฌุฏูุฏ:**

**File:** `scripts/my-script.ts`

```typescript
import { runScript } from '../lib/scriptManager'
import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

async function myScript() {
  // ููุฏ ุงูุณูุฑูุจุช ููุง
  await prisma.user.updateMany({
    where: { role: 'ADMIN' },
    data: { canAccessSettings: true }
  })

  console.log('โ ุชู ุชุญุฏูุซ ุตูุงุญูุงุช ุงูุฃุฏูู')
}

// โ ุชูููุฐ ุงูุณูุฑูุจุช ูุน ุงูุชุชุจุน
runScript('my-script-v1', myScript)
  .then(result => {
    if (result.success) {
      console.log('โ ูุฌุญ')
    } else {
      console.error('โ ูุดู:', result.error)
    }
    process.exit(result.success ? 0 : 1)
  })
```

#### **2. ุชุดุบูู ุงูุณูุฑูุจุช:**

```bash
npx ts-node scripts/my-script.ts
```

**ูุงุฐุง ูุญุฏุซุ**
1. ูุชุญูู ุฅุฐุง ูุงู ุงูุณูุฑูุจุช ุชู ุชูููุฐู ูุณุจูุงู
2. ุฅุฐุง ูู ูุชู ุชูููุฐูุ ูููุฐู
3. ูุณุฌู ุงููุชูุฌุฉ (ูุฌุงุญ/ูุดู) ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
4. ุฅุฐุง ุชู ุชูููุฐู ูุณุจูุงูุ ูุชุฎุทุงู

#### **3. ุฅุฏุงุฑุฉ ุงูุณูุฑูุจุชุงุช ูู ุงููุงุฌูุฉ:**

1. ุงุฐูุจ ุฅูู **ุงูุฅุนุฏุงุฏุงุช > ุฅุฏุงุฑุฉ ุงูุณูุฑูุจุชุงุช**
2. ุดุงูุฏ ูุงุฆูุฉ ุงูุณูุฑูุจุชุงุช ุงููููุฐุฉ
3. ููููู **ุฅุนุงุฏุฉ ุชุนููู** ุณูุฑูุจุช ูุชูููุฐู ูุฑุฉ ุฃุฎุฑู

#### **4. ุฅุนุงุฏุฉ ุชุนููู ุณูุฑูุจุช ุจุฑูุฌูุงู:**

```typescript
import { resetScript } from '@/lib/scriptManager'

await resetScript('my-script-v1')
console.log('ุชู ุฅุนุงุฏุฉ ุงูุชุนูููุ ูููู ุชูููุฐู ูุฑุฉ ุฃุฎุฑู')
```

#### **5. ุงูุชุญูู ุฅุฐุง ูุงู ุณูุฑูุจุช ูููุฐ:**

```typescript
import { isScriptExecuted } from '@/lib/scriptManager'

const executed = await isScriptExecuted('my-script-v1')
if (executed) {
  console.log('ุงูุณูุฑูุจุช ุชู ุชูููุฐู ูุณุจูุงู')
}
```

---

## ๐๏ธ ูููู ุงููููุงุช

```
lib/
โโโ pdfSystem.ts          # ูุธุงู ุชุญููู PDF
โโโ printSystem.ts        # ูุธุงู ุงูุทุจุงุนุฉ (ูุญุฏูุซ)
โโโ scriptManager.ts      # ูุธุงู ุฅุฏุงุฑุฉ ุงูุณูุฑูุจุชุงุช

scripts/
โโโ create-admin.ts       # ุณูุฑูุจุช ุฅูุดุงุก ุฃุฏูู (ูุญุฏูุซ)
โโโ [your-scripts].ts     # ุณูุฑูุจุชุงุช ุฃุฎุฑู

app/
โโโ api/
โ   โโโ scripts/
โ       โโโ route.ts        # API ุฌูุจ ุงูุณูุฑูุจุชุงุช
โ       โโโ reset/
โ           โโโ route.ts    # API ุฅุนุงุฏุฉ ุชุนููู ุณูุฑูุจุช
โโโ settings/
    โโโ scripts-manager.tsx # ูุงุฌูุฉ ุฅุฏุงุฑุฉ ุงูุณูุฑูุจุชุงุช
```

---

## โ๏ธ ุงูุฅุนุฏุงุฏุงุช

### **1. ุชุฎุตูุต ูุฌูุฏ ุญูุธ PDF:**

```typescript
// ูู Electron main.js
ipcMain.handle('save-pdf', async (event, buffer, fileName, folder) => {
  const downloadsPath = app.getPath('downloads')
  const customPath = path.join(downloadsPath, folder || 'receipts')

  // ุฅูุดุงุก ุงููุฌูุฏ ุฅุฐุง ูู ููู ููุฌูุฏ
  if (!fs.existsSync(customPath)) {
    fs.mkdirSync(customPath, { recursive: true })
  }

  const filePath = path.join(customPath, fileName)
  fs.writeFileSync(filePath, buffer)

  return { filePath }
})
```

### **2. ุชุฎุตูุต ุฌูุฏุฉ PDF:**

```typescript
// ูู pdfSystem.ts
const canvas = await html2canvas(container, {
  scale: 3,  // โฌ๏ธ ุฌูุฏุฉ ุฃุนูู (ููู ุญุฌู ุฃูุจุฑ)
  useCORS: true,
  logging: false
})
```

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### **1. ุงุฎุชุจุงุฑ PDF:**

```bash
# ุชุดุบูู ุงููุธุงู
npm run dev

# ุงูุชุญ ุฃู ุตูุญุฉ ุจูุง ุฅูุตุงูุงุช
# ุงุถุบุท "ุทุจุงุนุฉ ุฅูุตุงู"
# ุชุญูู ูู:
# โ ูุชุญุช ูุงูุฐุฉ ุงูุทุจุงุนุฉุ
# โ ุชู ุชุญููู PDF ุชููุงุฆูุงูุ
# โ PDF ุจุฌูุฏุฉ ุนุงููุฉุ
```

### **2. ุงุฎุชุจุงุฑ ุงูุณูุฑูุจุชุงุช:**

```bash
# ุฅูุดุงุก ุณูุฑูุจุช ุชุฌุฑูุจู
npx ts-node scripts/create-admin.ts

# ุงููุญุงููุฉ ุงูุฃููู: ูููุฐ ุงูุณูุฑูุจุช
# ุงููุญุงููุฉ ุงูุซุงููุฉ: ูุชุฎุทุงู (ุชู ุงูุชูููุฐ ูุณุจูุงู)

# ุฅุนุงุฏุฉ ุงูุชุนููู ูู ุงููุงุฌูุฉ
# ุงููุญุงููุฉ ุงูุซุงูุซุฉ: ูููุฐู ูุฑุฉ ุฃุฎุฑู
```

---

## ๐ฏ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู

### **๐ PDF:**

1. **ุทุจุงุนุฉ ุนุงุฏูุฉ:** ูุทุจุน + ูุญูุธ PDF
2. **PDF ููุท:** ูุญูุธ PDF ุจุฏูู ุทุจุงุนุฉ (ููุฃุฑุดูุฉ)
3. **ุฅุฑุณุงู WhatsApp:** ูุญููู ูู PDF ูููุชุญ WhatsApp
4. **ุญูุธ ูุญูู:** ูุญูุธ ูู ูุฌูุฏ ูุญุฏุฏ (Electron)

### **๐ ุงูุณูุฑูุจุชุงุช:**

1. **Migrations:** ุชุญุฏูุซ ุฌุฏุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. **Seed Data:** ุฅุฏุฎุงู ุจูุงูุงุช ุฃูููุฉ
3. **Permission Updates:** ุชุญุฏูุซ ุตูุงุญูุงุช ุงููุณุชุฎุฏููู
4. **Data Fixes:** ุฅุตูุงุญ ุจูุงูุงุช ุฎุงุทุฆุฉ
5. **One-time Tasks:** ููุงู ููุฑุฉ ูุงุญุฏุฉ

---

## ๐จ ููุงุญุธุงุช ูููุฉ

### **PDF:**
- โ๏ธ ูุชุทูุจ `jspdf` ู `html2canvas` (ุชู ุงูุชุซุจูุช)
- โ๏ธ ูุฏ ูููู ุจุทูุฆุงู ุนูู ุงูุฃุฌูุฒุฉ ุงูุถุนููุฉ (ุงุณุชุฎุฏู `pdfOnly: true`)
- โ๏ธ WhatsApp Web ูุง ูุฏุนู ุฅุฑูุงู ูููุงุช ุจุฑูุฌูุงู (ููุชุญ ุฑุงุจุท + ูุญูู PDF ูููุตู)
- โ **ุฏุนู ุงูุนุฑุจู:** ุงููุธุงู ูุณุชุฎุฏู `html2canvas` ุจุฏูุฉ ุนุงููุฉ (scale: 4) ูุถูุงู ูุถูุญ ุงูุฎุทูุท ุงูุนุฑุจูุฉ
- โ **ุงูุฎุทูุท:** ูุณุชุฎุฏู Segoe UI, Tahoma, Arial (ุฎุทูุท ุฏุงุนูุฉ ููุนุฑุจู)
- โ **ุงูุฌูุฏุฉ:** PDF ุจุตูุบุฉ JPEG ุจุฌูุฏุฉ 95% ูุชูุงุฒู ุงูุญุฌู ูุงูุฌูุฏุฉ

### **ุงูุณูุฑูุจุชุงุช:**
- โ๏ธ ุชููุฐ ูุฑุฉ ูุงุญุฏุฉ ููุท (ุฅูุง ุฅุฐุง ุชูุช ุฅุนุงุฏุฉ ุงูุชุนููู)
- โ๏ธ ูุฌุจ ุฃู ูููู ุงุณู ุงูุณูุฑูุจุช unique (ูุซู: `update-admin-v2`)
- โ๏ธ ุงูุณูุฑูุจุชุงุช ุงููุงุดูุฉ ูุชู ุชุณุฌูููุง (ูููู ุฑุคูุฉ ุงูุฎุทุฃ)

---

## โ ุงูุชุญุฏูุซุงุช ุงููุทููุจุฉ ูู ุงููุณุชูุจู

- [ ] ุฅุถุงูุฉ watermark ุนูู PDF
- [ ] ุฏุนู ุฅุฑุณุงู PDF ุนุจุฑ Email
- [ ] ุถุบุท PDF ูุชูููู ุงูุญุฌู
- [ ] Batch PDF generation
- [ ] Automatic backups ููููุงุช PDF
- [ ] ุณูุฑูุจุชุงุช ูุฌุฏููุฉ (Cron)
