# Staff Edit & Delete Fix

## ุงููุดููุฉ
ูุงูุช ุตูุญุฉ ุงูููุธููู ูุง ุชุญุชูู ุนูู ุฒุฑ ุญุฐูุ ููุง ุฌุนู ูู ุงููุณุชุญูู ุญุฐู ุงูููุธููู ูู ุงููุงุฌูุฉ.

## ุงูุญู ุงููุทุจู โ

### 1. ุฅุถุงูุฉ Imports ุงููุทููุจุฉ
```typescript
import { useConfirm } from '../../hooks/useConfirm'
import ConfirmDialog from '../../components/ConfirmDialog'
```

### 2. ุฅุถุงูุฉ useConfirm Hook
```typescript
const { confirm, isOpen, options, handleConfirm, handleCancel } = useConfirm()
```

### 3. ุฅุถุงูุฉ ุฏุงูุฉ handleDelete
```typescript
const handleDelete = async (staffMember: Staff) => {
  const confirmed = await confirm({
    title: 'โ๏ธ ุญุฐู ููุธู',
    message: `ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ุงูููุธู "${staffMember.name}" (ุฑูู ${staffMember.staffCode})?\n\nุณูุชู ุญุฐู ุฌููุน ุณุฌูุงุช ุงูุญุถูุฑ ูุงูุงูุตุฑุงู ุงููุฑุชุจุทุฉ ุจู!\n\nูุง ูููู ุงูุชุฑุงุฌุน ุนู ูุฐุง ุงูุฅุฌุฑุงุก.`,
    confirmText: 'ูุนูุ ุงุญุฐู',
    cancelText: 'ุฅูุบุงุก',
    type: 'danger'
  })

  if (!confirmed) return

  try {
    const response = await fetch(`/api/staff?id=${staffMember.id}`, {
      method: 'DELETE',
    })

    if (!response.ok) {
      const errorData = await response.json()
      throw new Error(errorData.error || 'ูุดู ุญุฐู ุงูููุธู')
    }

    setMessage('โ ุชู ุญุฐู ุงูููุธู ุจูุฌุงุญ')
    fetchStaff()
    fetchTodayAttendance()
    setTimeout(() => setMessage(''), 3000)
  } catch (error: any) {
    console.error('Error:', error)
    setMessage(`โ ${error.message || 'ุญุฏุซ ุฎุทุฃ ูู ุงูุญุฐู'}`)
    setTimeout(() => setMessage(''), 5000)
  }
}
```

### 4. ุฅุถุงูุฉ ุฒุฑ ุงูุญุฐู ูู ุงูุฌุฏูู
```typescript
<button
  onClick={() => handleDelete(staffMember)}
  className="text-red-600 hover:text-red-800 font-semibold transition hover:underline"
>
  ๐๏ธ ุญุฐู
</button>
```

### 5. ุฅุถุงูุฉ ConfirmDialog Component
```typescript
<ConfirmDialog
  isOpen={isOpen}
  title={options.title}
  message={options.message}
  confirmText={options.confirmText}
  cancelText={options.cancelText}
  onConfirm={handleConfirm}
  onCancel={handleCancel}
  type={options.type}
/>
```

## ุงูููุฒุงุช ุงูุขู โจ

### ุงูุชุนุฏูู โ๏ธ
- ูุนูู ุจุดูู ุตุญูุญ
- ูููุฃ ุงููููุฐุฌ ุจุงูุจูุงูุงุช ุงูุญุงููุฉ
- ุฑูู ุงูููุธู (staffCode) ูุนุทู ุนูุฏ ุงูุชุนุฏูู (ูุง ูููู ุชุบููุฑู)
- API route ูุชุญูู ูู ุนุฏู ุชูุฑุงุฑ ุงูุฑูู ุฅุฐุง ุชู ุชุบููุฑู

### ุงูุญุฐู ๐๏ธ
- ุฒุฑ ุญุฐู ุฌุฏูุฏ ุจุฌุงูุจ ุฒุฑ ุงูุชุนุฏูู
- ูุธูุฑ confirm dialog ูุจู ุงูุญุฐู
- ุฑุณุงูุฉ ุชุญุฐูุฑ ูุงุถุญุฉ ุชูุถุญ ุฃู:
  - ุณูุชู ุญุฐู ุงูููุธู
  - ุณูุชู ุญุฐู ุฌููุน ุณุฌูุงุช ุงูุญุถูุฑ ูุงูุงูุตุฑุงู
  - ูุง ูููู ุงูุชุฑุงุฌุน ุนู ูุฐุง ุงูุฅุฌุฑุงุก
- ุฑุณุงูุฉ ูุฌุงุญ ุจุนุฏ ุงูุญุฐู
- ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ ุฅุฐุง ูุดู ุงูุญุฐู
- ูุชู ุชุญุฏูุซ ูุงุฆูุฉ ุงูููุธููู ูุญุถูุฑ ุงูููู ุชููุงุฆูุงู ุจุนุฏ ุงูุญุฐู

## ุงูุฃูุงู ๐

### ุตูุงุญูุงุช API
- **ุงูุชุนุฏูู**: ูุชุทูุจ ุตูุงุญูุฉ `canEditStaff`
- **ุงูุญุฐู**: ูุชุทูุจ ุตูุงุญูุฉ `canDeleteStaff`

### ุญูุงูุฉ ุงูุจูุงูุงุช
- ูุญุฐู Prisma ุชููุงุฆูุงู ุฌููุน ุณุฌูุงุช ุงูุญุถูุฑ ุงููุฑุชุจุทุฉ ุจุงูููุธู (`onDelete: Cascade`)
- ุงูุชุญูู ูู ูุฌูุฏ ID ูุจู ุงูุญุฐู
- ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุจุดูู ุตุญูุญ

## ูุซุงู ุนูู ุงูุงุณุชุฎุฏุงู

### ุชุนุฏูู ููุธู:
1. ุงุถุบุท ุนูู ุฒุฑ "โ๏ธ ุชุนุฏูู" ุจุฌุงูุจ ุงูููุธู
2. ุณูุชู ููุก ุงููููุฐุฌ ุจุงูุจูุงูุงุช ุงูุญุงููุฉ
3. ุนุฏูู ุงูุจูุงูุงุช ุงููุทููุจุฉ
4. ุงุถุบุท "โ ุชุญุฏูุซ"
5. ุณุชุธูุฑ ุฑุณุงูุฉ "โ ุชู ุชุญุฏูุซ ุงูููุธู ุจูุฌุงุญ!"

### ุญุฐู ููุธู:
1. ุงุถุบุท ุนูู ุฒุฑ "๐๏ธ ุญุฐู" ุจุฌุงูุจ ุงูููุธู
2. ุณูุธูุฑ confirm dialog ูุน ุชุญุฐูุฑ
3. ุงุถุบุท "ูุนูุ ุงุญุฐู" ููุชุฃููุฏ ุฃู "ุฅูุบุงุก" ููุฅูุบุงุก
4. ุฅุฐุง ุชู ุงูุชุฃููุฏุ ุณูุชู ุญุฐู ุงูููุธู
5. ุณุชุธูุฑ ุฑุณุงูุฉ "โ ุชู ุญุฐู ุงูููุธู ุจูุฌุงุญ!"

## ููุงุญุธุงุช ูููุฉ โ๏ธ

1. **ุฑูู ุงูููุธู (staffCode)**:
   - ูุง ูููู ุชุบููุฑู ุจุนุฏ ุฅูุดุงุก ุงูููุธู
   - ูุฐุง ูุชุฌูุจ ุชุนุงุฑุถุงุช ูู ุณุฌูุงุช ุงูุญุถูุฑ

2. **ุงูุญุฐู ููุงุฆู**:
   - ูุง ูููู ุงูุชุฑุงุฌุน ุนู ุงูุญุฐู
   - ูุชู ุญุฐู ุฌููุน ุงูุจูุงูุงุช ุงููุฑุชุจุทุฉ ุจุงูููุธู
   - ุงุณุชุฎุฏู "ุฅูุบุงุก ุงูุชูุนูู" ุจุฏูุงู ูู ุงูุญุฐู ุฅุฐุง ุฃุฑุฏุช ุงูุงุญุชูุงุธ ุจุงูุจูุงูุงุช

3. **ุณุฌูุงุช ุงูุญุถูุฑ**:
   - ุนูุฏ ุญุฐู ููุธูุ ูุชู ุญุฐู ุฌููุน ุณุฌูุงุช ุญุถูุฑู ุชููุงุฆูุงู
   - ูุฐุง ุจุณุจุจ `onDelete: Cascade` ูู schema

## ุงููููุงุช ุงููุนุฏูุฉ

1. `app/staff/page.tsx`:
   - ุฅุถุงูุฉ imports
   - ุฅุถุงูุฉ useConfirm hook
   - ุฅุถุงูุฉ ุฏุงูุฉ handleDelete
   - ุฅุถุงูุฉ ุฒุฑ ุงูุญุฐู ูู ุงูุฌุฏูู
   - ุฅุถุงูุฉ ConfirmDialog component

2. `app/api/staff/route.ts`:
   - ูุงู ูุนูู ุจุดูู ุตุญูุญ ุจุงููุนู
   - ูู ูุชู ุชุนุฏููู

---
**ุชุงุฑูุฎ ุงูุฅุตูุงุญ**: ุฏูุณูุจุฑ 2025
**ุงูุญุงูุฉ**: โ ุชู ุงูุฅุตูุงุญ ูุงูุงุฎุชุจุงุฑ
